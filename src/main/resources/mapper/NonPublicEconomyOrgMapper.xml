<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jtzh.mapper.NonPublicEconomyOrgMapper">
    <resultMap id="BaseResultMap" type="com.jtzh.entity.NonPublicEconomyOrg">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="EnterpriseUSCcode" jdbcType="CHAR" property="enterpriseUSCcode"/>
        <result column="EnterpriseName" jdbcType="VARCHAR" property="enterpriseName"/>
        <result column="EnterpriseTypeValue" jdbcType="CHAR" property="enterpriseTypeValue"/>
        <result column="EnterpriseAddress" jdbcType="VARCHAR" property="enterpriseAddress"/>
        <result column="RegionalismCode" jdbcType="VARCHAR" property="regionalismCode"/>
        <result column="EnterpriseContact" jdbcType="VARCHAR" property="enterpriseContact"/>
        <result column="EnterpriseMemberNumber" jdbcType="INTEGER" property="enterpriseMemberNumber"/>
        <result column="EnterpriseLeaderCertTypeValue" jdbcType="CHAR" property="enterpriseLeaderCertTypeValue"/>
        <result column="EnterpriseLeaderCertID" jdbcType="VARCHAR" property="enterpriseLeaderCertID"/>
        <result column="EnterpriseLeaderName" jdbcType="VARCHAR" property="enterpriseLeaderName"/>
        <result column="EnterpriseLeaderContact" jdbcType="VARCHAR" property="enterpriseLeaderContact"/>
        <result column="SecurityLeaderCertID" jdbcType="VARCHAR" property="securityLeaderCertID"/>
        <result column="SecurityLeaderName" jdbcType="VARCHAR" property="securityLeaderName"/>
        <result column="SecurityLeaderContact" jdbcType="VARCHAR" property="securityLeaderContact"/>
        <result column="ChairmanCertID" jdbcType="VARCHAR" property="chairmanCertID"/>
        <result column="ChairmanName" jdbcType="VARCHAR" property="chairmanName"/>
        <result column="ChairmanContact" jdbcType="VARCHAR" property="chairmanContact"/>
        <result column="GeneralManagerCertID" jdbcType="VARCHAR" property="generalManagerCertID"/>
        <result column="GeneralManagerName" jdbcType="VARCHAR" property="generalManagerName"/>
        <result column="GeneralManagerContact" jdbcType="VARCHAR" property="generalManagerContact"/>
        <result column="IsDangeriousEnterprise" jdbcType="INTEGER" property="isDangeriousEnterprise"/>
        <result column="HiddenDangerTypeValue" jdbcType="CHAR" property="hiddenDangerTypeValue"/>
        <result column="AttentionTypeValue" jdbcType="CHAR" property="attentionTypeValue"/>
        <result column="IsCanConstructCPC" jdbcType="INTEGER" property="isCanConstructCPC"/>
        <result column="HasCPC" jdbcType="INTEGER" property="hasCPC"/>
        <result column="NumberofCPCMember" jdbcType="INTEGER" property="numberofCPCMember"/>
        <result column="HasLabourUnion" jdbcType="INTEGER" property="hasLabourUnion"/>
        <result column="NumberofLUMember" jdbcType="INTEGER" property="numberofLUMember"/>
        <result column="HasCYL" jdbcType="INTEGER" property="hasCYL"/>
        <result column="NumberofLCYLMember" jdbcType="INTEGER" property="numberofLCYLMember"/>
        <result column="HasWomenFederation" jdbcType="INTEGER" property="hasWomenFederation"/>
        <result column="NumberofWomen" jdbcType="INTEGER" property="numberofWomen"/>
        <result column="Longitude" jdbcType="DOUBLE" property="longitude"/>
        <result column="Latitude" jdbcType="DOUBLE" property="latitude"/>
        <result column="NetGridID" jdbcType="BIGINT" property="netGridID"/>
        <result column="IsLogisticsEnterprise" jdbcType="INTEGER" property="isLogisticsEnterprise"/>
        <result column="IsKeyEnterprise" jdbcType="INTEGER" property="isKeyEnterprise"/>
        <result column="BusinessScope" jdbcType="VARCHAR" property="businessScope"/>
    </resultMap>
    <resultMap id="NonPublicEconomyOrgDetailVO" type="com.jtzh.vo.nonpublic.NonPublicEconomyOrgDetailVO">
        <id column="EnterpriseUSCcode" jdbcType="CHAR" property="enterpriseUSCcode"/>
        <result column="EnterpriseName" jdbcType="VARCHAR" property="enterpriseName"/>
        <result column="EnterpriseTypeName" jdbcType="CHAR" property="enterpriseTypeName"/>
        <result column="EnterpriseAddress" jdbcType="VARCHAR" property="enterpriseAddress"/>
        <result column="RegionalismCode" jdbcType="VARCHAR" property="regionalismCode"/>
        <result column="EnterpriseContact" jdbcType="VARCHAR" property="enterpriseContact"/>
        <result column="EnterpriseMemberNumber" jdbcType="INTEGER" property="enterpriseMemberNumber"/>
        <result column="EnterpriseLeaderCertTypeName" jdbcType="CHAR" property="enterpriseLeaderCertTypeName"/>
        <result column="EnterpriseLeaderCertID" jdbcType="VARCHAR" property="enterpriseLeaderCertID"/>
        <result column="EnterpriseLeaderName" jdbcType="VARCHAR" property="enterpriseLeaderName"/>
        <result column="EnterpriseLeaderContact" jdbcType="VARCHAR" property="enterpriseLeaderContact"/>
        <result column="SecurityLeaderCertID" jdbcType="VARCHAR" property="securityLeaderCertID"/>
        <result column="SecurityLeaderName" jdbcType="VARCHAR" property="securityLeaderName"/>
        <result column="SecurityLeaderContact" jdbcType="VARCHAR" property="securityLeaderContact"/>
        <result column="ChairmanCertID" jdbcType="VARCHAR" property="chairmanCertID"/>
        <result column="ChairmanName" jdbcType="VARCHAR" property="chairmanName"/>
        <result column="ChairmanContact" jdbcType="VARCHAR" property="chairmanContact"/>
        <result column="GeneralManagerCertID" jdbcType="VARCHAR" property="generalManagerCertID"/>
        <result column="GeneralManagerName" jdbcType="VARCHAR" property="generalManagerName"/>
        <result column="GeneralManagerContact" jdbcType="VARCHAR" property="generalManagerContact"/>
        <result column="IsDangeriousEnterprise" jdbcType="INTEGER" property="isDangeriousEnterprise"/>
        <result column="HiddenDangerTypeName" jdbcType="CHAR" property="hiddenDangerTypeName"/>
        <result column="AttentionTypeName" jdbcType="CHAR" property="attentionTypeName"/>
        <result column="IsCanConstructCPC" jdbcType="INTEGER" property="isCanConstructCPC"/>
        <result column="HasCPC" jdbcType="INTEGER" property="hasCPC"/>
        <result column="NumberofCPCMember" jdbcType="INTEGER" property="numberofCPCMember"/>
        <result column="HasLabourUnion" jdbcType="INTEGER" property="hasLabourUnion"/>
        <result column="NumberofLUMember" jdbcType="INTEGER" property="numberofLUMember"/>
        <result column="HasCYL" jdbcType="INTEGER" property="hasCYL"/>
        <result column="NumberofLCYLMember" jdbcType="INTEGER" property="numberofLCYLMember"/>
        <result column="HasWomenFederation" jdbcType="INTEGER" property="hasWomenFederation"/>
        <result column="NumberofWomen" jdbcType="INTEGER" property="numberofWomen"/>
        <result column="Longitude" jdbcType="DOUBLE" property="longitude"/>
        <result column="Latitude" jdbcType="DOUBLE" property="latitude"/>
        <result column="NetGridName" jdbcType="VARCHAR" property="netGridName"/>
        <result column="BusinessScope" jdbcType="VARCHAR" property="businessScope"/>
    </resultMap>

    <resultMap id="NonpublicHistogramVO" type="com.jtzh.vo.nonpublic.NonpublicHistogramVO">
        <result column="NetGridName" jdbcType="VARCHAR" property="name"/>
        <result column="Count" jdbcType="VARCHAR" property="count"/>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from TENonPublicEconomyOrg
        where EnterpriseUSCcode = #{enterpriseUSCcode,jdbcType=CHAR}
    </delete>
    <insert id="insert" parameterType="com.jtzh.entity.NonPublicEconomyOrg">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into TENonPublicEconomyOrg (EnterpriseUSCcode, EnterpriseName, EnterpriseTypeValue,
        EnterpriseAddress, RegionalismCode, EnterpriseContact,
        EnterpriseMemberNumber, EnterpriseLeaderCertTypeValue,
        EnterpriseLeaderCertID, EnterpriseLeaderName,
        EnterpriseLeaderContact, SecurityLeaderCertID,
        SecurityLeaderName, SecurityLeaderContact,
        ChairmanCertID, ChairmanName, ChairmanContact,
        GeneralManagerCertID, GeneralManagerName,
        GeneralManagerContact, IsDangeriousEnterprise,
        HiddenDangerTypeValue, AttentionTypeValue, IsCanConstructCPC,
        HasCPC, NumberofCPCMember, HasLabourUnion,
        NumberofLUMember, HasCYL, NumberofLCYLMember,
        HasWomenFederation, NumberofWomen, Longitude,
        Latitude, NetGridID, IsLogisticsEnterprise,
        IsKeyEnterprise, BusinessScope)
        values (#{enterpriseUSCcode,jdbcType=CHAR}, #{enterpriseName,jdbcType=VARCHAR},
        #{enterpriseTypeValue,jdbcType=CHAR},
        #{enterpriseAddress,jdbcType=VARCHAR}, #{regionalismCode,jdbcType=VARCHAR},
        #{enterpriseContact,jdbcType=VARCHAR},
        #{enterpriseMemberNumber,jdbcType=INTEGER}, #{enterpriseLeaderCertTypeValue,jdbcType=CHAR},
        #{enterpriseLeaderCertID,jdbcType=VARCHAR}, #{enterpriseLeaderName,jdbcType=VARCHAR},
        #{enterpriseLeaderContact,jdbcType=VARCHAR}, #{securityLeaderCertID,jdbcType=VARCHAR},
        #{securityLeaderName,jdbcType=VARCHAR}, #{securityLeaderContact,jdbcType=VARCHAR},
        #{chairmanCertID,jdbcType=VARCHAR}, #{chairmanName,jdbcType=VARCHAR}, #{chairmanContact,jdbcType=VARCHAR},
        #{generalManagerCertID,jdbcType=VARCHAR}, #{generalManagerName,jdbcType=VARCHAR},
        #{generalManagerContact,jdbcType=VARCHAR}, #{isDangeriousEnterprise,jdbcType=INTEGER},
        #{hiddenDangerTypeValue,jdbcType=CHAR}, #{attentionTypeValue,jdbcType=CHAR},
        #{isCanConstructCPC,jdbcType=INTEGER},
        #{hasCPC,jdbcType=INTEGER}, #{numberofCPCMember,jdbcType=INTEGER}, #{hasLabourUnion,jdbcType=INTEGER},
        #{numberofLUMember,jdbcType=INTEGER}, #{hasCYL,jdbcType=INTEGER}, #{numberofLCYLMember,jdbcType=INTEGER},
        #{hasWomenFederation,jdbcType=INTEGER}, #{numberofWomen,jdbcType=INTEGER}, #{longitude,jdbcType=DOUBLE},
        #{latitude,jdbcType=DOUBLE}, #{netGridID,jdbcType=BIGINT}, #{isLogisticsEnterprise,jdbcType=INTEGER},
        #{isKeyEnterprise,jdbcType=INTEGER}, #{businessScope,jdbcType=VARCHAR})
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.jtzh.entity.NonPublicEconomyOrg">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update TENonPublicEconomyOrg
        set EnterpriseName = #{enterpriseName,jdbcType=VARCHAR},
        EnterpriseTypeValue = #{enterpriseTypeValue,jdbcType=CHAR},
        EnterpriseAddress = #{enterpriseAddress,jdbcType=VARCHAR},
        RegionalismCode = #{regionalismCode,jdbcType=VARCHAR},
        EnterpriseContact = #{enterpriseContact,jdbcType=VARCHAR},
        EnterpriseMemberNumber = #{enterpriseMemberNumber,jdbcType=INTEGER},
        EnterpriseLeaderCertTypeValue = #{enterpriseLeaderCertTypeValue,jdbcType=CHAR},
        EnterpriseLeaderCertID = #{enterpriseLeaderCertID,jdbcType=VARCHAR},
        EnterpriseLeaderName = #{enterpriseLeaderName,jdbcType=VARCHAR},
        EnterpriseLeaderContact = #{enterpriseLeaderContact,jdbcType=VARCHAR},
        SecurityLeaderCertID = #{securityLeaderCertID,jdbcType=VARCHAR},
        SecurityLeaderName = #{securityLeaderName,jdbcType=VARCHAR},
        SecurityLeaderContact = #{securityLeaderContact,jdbcType=VARCHAR},
        ChairmanCertID = #{chairmanCertID,jdbcType=VARCHAR},
        ChairmanName = #{chairmanName,jdbcType=VARCHAR},
        ChairmanContact = #{chairmanContact,jdbcType=VARCHAR},
        GeneralManagerCertID = #{generalManagerCertID,jdbcType=VARCHAR},
        GeneralManagerName = #{generalManagerName,jdbcType=VARCHAR},
        GeneralManagerContact = #{generalManagerContact,jdbcType=VARCHAR},
        IsDangeriousEnterprise = #{isDangeriousEnterprise,jdbcType=INTEGER},
        HiddenDangerTypeValue = #{hiddenDangerTypeValue,jdbcType=CHAR},
        AttentionTypeValue = #{attentionTypeValue,jdbcType=CHAR},
        IsCanConstructCPC = #{isCanConstructCPC,jdbcType=INTEGER},
        HasCPC = #{hasCPC,jdbcType=INTEGER},
        NumberofCPCMember = #{numberofCPCMember,jdbcType=INTEGER},
        HasLabourUnion = #{hasLabourUnion,jdbcType=INTEGER},
        NumberofLUMember = #{numberofLUMember,jdbcType=INTEGER},
        HasCYL = #{hasCYL,jdbcType=INTEGER},
        NumberofLCYLMember = #{numberofLCYLMember,jdbcType=INTEGER},
        HasWomenFederation = #{hasWomenFederation,jdbcType=INTEGER},
        NumberofWomen = #{numberofWomen,jdbcType=INTEGER},
        Longitude = #{longitude,jdbcType=DOUBLE},
        Latitude = #{latitude,jdbcType=DOUBLE},
        NetGridID = #{netGridID,jdbcType=BIGINT},
        IsLogisticsEnterprise = #{isLogisticsEnterprise,jdbcType=INTEGER},
        IsKeyEnterprise = #{isKeyEnterprise,jdbcType=INTEGER},
        BusinessScope = #{businessScope,jdbcType=VARCHAR}
        where EnterpriseUSCcode = #{enterpriseUSCcode,jdbcType=CHAR}
    </update>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select EnterpriseUSCcode, EnterpriseName, EnterpriseTypeValue, EnterpriseAddress,
        RegionalismCode, EnterpriseContact, EnterpriseMemberNumber, EnterpriseLeaderCertTypeValue,
        EnterpriseLeaderCertID, EnterpriseLeaderName, EnterpriseLeaderContact, SecurityLeaderCertID,
        SecurityLeaderName, SecurityLeaderContact, ChairmanCertID, ChairmanName, ChairmanContact,
        GeneralManagerCertID, GeneralManagerName, GeneralManagerContact, IsDangeriousEnterprise,
        HiddenDangerTypeValue, AttentionTypeValue, IsCanConstructCPC, HasCPC, NumberofCPCMember,
        HasLabourUnion, NumberofLUMember, HasCYL, NumberofLCYLMember, HasWomenFederation,
        NumberofWomen, Longitude, Latitude, NetGridID, IsLogisticsEnterprise, IsKeyEnterprise,
        BusinessScope
        from TENonPublicEconomyOrg
        where EnterpriseUSCcode = #{enterpriseUSCcode,jdbcType=CHAR}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        select EnterpriseUSCcode, EnterpriseName, EnterpriseTypeValue, EnterpriseAddress,
        RegionalismCode, EnterpriseContact, EnterpriseMemberNumber, EnterpriseLeaderCertTypeValue,
        EnterpriseLeaderCertID, EnterpriseLeaderName, EnterpriseLeaderContact, SecurityLeaderCertID,
        SecurityLeaderName, SecurityLeaderContact, ChairmanCertID, ChairmanName, ChairmanContact,
        GeneralManagerCertID, GeneralManagerName, GeneralManagerContact, IsDangeriousEnterprise,
        HiddenDangerTypeValue, AttentionTypeValue, IsCanConstructCPC, HasCPC, NumberofCPCMember,
        HasLabourUnion, NumberofLUMember, HasCYL, NumberofLCYLMember, HasWomenFederation,
        NumberofWomen, Longitude, Latitude, NetGridID, IsLogisticsEnterprise, IsKeyEnterprise,
        BusinessScope
        from TENonPublicEconomyOrg
        where 1=1
        <if test="netGridID != 0 and netGridID !=null">
            and NetGridID= #{netGridID}
        </if>
    </select>
    <!-- 获取重点企业编码 -->
    <select id="getKeyEnterpriseUSCcode" resultMap="BaseResultMap">
        select EnterpriseUSCcode, EnterpriseName, EnterpriseTypeValue, EnterpriseAddress,
        RegionalismCode, EnterpriseContact, EnterpriseMemberNumber, EnterpriseLeaderCertTypeValue,
        EnterpriseLeaderCertID, EnterpriseLeaderName, EnterpriseLeaderContact, SecurityLeaderCertID,
        SecurityLeaderName, SecurityLeaderContact, ChairmanCertID, ChairmanName, ChairmanContact,
        GeneralManagerCertID, GeneralManagerName, GeneralManagerContact, IsDangeriousEnterprise,
        HiddenDangerTypeValue, AttentionTypeValue, IsCanConstructCPC, HasCPC, NumberofCPCMember,
        HasLabourUnion, NumberofLUMember, HasCYL, NumberofLCYLMember, HasWomenFederation,
        NumberofWomen, Longitude, Latitude, NetGridID, IsLogisticsEnterprise, IsKeyEnterprise,
        BusinessScope
        from TENonPublicEconomyOrg
        where IsKeyEnterprise=1
    </select>

    <select id="getNonPublicEconomyOrgInfo"
            resultType="com.jtzh.vo.nonpublic.NonPublicEconomyOrgInfoVO">
        SELECT
        t1.EnterpriseUSCcode,t1.EnterpriseName,t2.EnterpriseTypeName,t1.EnterpriseAddress,t1.EnterpriseLeaderName,t1.EnterpriseLeaderContact,t1.SecurityLeaderContact
        FROM TENonPublicEconomyOrg t1
        left join TECODEEnterpriseType t2
        on
        t1.EnterpriseTypeValue=t2.EnterpriseTypeValue
        where 1=1
        <if test="name != null and name != ''">
            and t1.EnterpriseName like CONCAT(CONCAT('%',
            #{name}),
            '%')
        </if>
        <if test="type != null and type != ''">
            and t1.EnterpriseTypeValue =
            #{type}
        </if>
        <if test="netGridID != 0 and netGridID !=null">
            and t1.NetGridID= #{netGridID}
        </if>
        <if test="isLogisticsEnterprise != 0 and isLogisticsEnterprise !=null">
            and t1.IsLogisticsEnterprise= #{isLogisticsEnterprise}
        </if>
        <if test="isKeyEnterprise != 0 and isKeyEnterprise !=null">
            and t1.IsKeyEnterprise= #{isKeyEnterprise}
        </if>
        limit #{start}, #{pageSize};
    </select>

    <select id="getNonPublicEconomyOrgDetailByCode" resultMap="NonPublicEconomyOrgDetailVO">
        SELECT
        t1.EnterpriseUSCcode,
        t1.EnterpriseName,
        t2.EnterpriseTypeName,
        t1.EnterpriseAddress,
        t1.RegionalismCode,
        t1.EnterpriseContact,
        t1.EnterpriseMemberNumber,
        t3.EnterpriseLeaderCertTypeName,
        t1.EnterpriseLeaderCertID,
        t1.EnterpriseLeaderName,
        t1.EnterpriseLeaderContact,
        t1.SecurityLeaderCertID,
        t1.SecurityLeaderName,
        t1.SecurityLeaderContact,
		t1.ChairmanCertID, t1.ChairmanName, t1.ChairmanContact,
        t1.GeneralManagerCertID, t1.GeneralManagerName, t1.GeneralManagerContact,
        t1.IsDangeriousEnterprise,
        t4.HiddenDangerTypeName,
        t5.AttentionTypeName,
        t1.IsCanConstructCPC,
        t1.HasCPC,
        t1.NumberofCPCMember,
        t1.HasLabourUnion,
        t1.NumberofLUMember,
        t1.HasCYL,
        t1.NumberofLCYLMember,
        t1.HasWomenFederation,
        t1.NumberofWomen,
        t1.Longitude,
        t1.Latitude,
        t6.NetGridName,
        t1.BusinessScope
        FROM
        TENonPublicEconomyOrg t1
        LEFT JOIN TECODEEnterpriseType t2
        ON
        t1.EnterpriseTypeValue =
        t2.EnterpriseTypeValue
        LEFT JOIN
        TECODEDocumentType t3
        ON
        t1.EnterpriseLeaderCertTypeValue =
        t3.EnterpriseLeaderCertTypeValue
        LEFT JOIN TECODEHiddenDangerType t4
        ON
        t1.HiddenDangerTypeValue =
        t4.HiddenDangerTypeValue
        LEFT JOIN
        TECODEAttentionTypeValue t5
        ON
        t1.AttentionTypeValue =
        t5.AttentionTypeValue
        LEFT JOIN TENetGrid t6
        ON
        t1.NetGridID=t6.NetGridID where EnterpriseUSCcode=#{code};

    </select>

    <select id="getNonPublicEconomyOrgDetailForGIS" resultMap="NonPublicEconomyOrgDetailVO">
        SELECT
        t1.EnterpriseUSCcode,
        t1.EnterpriseName,
        t2.EnterpriseTypeName,
        t1.EnterpriseAddress,
        t1.RegionalismCode,
        t1.EnterpriseContact,
        t1.EnterpriseMemberNumber,
        t3.EnterpriseLeaderCertTypeName,
        t1.EnterpriseLeaderCertID,
        t1.EnterpriseLeaderName,
        t1.EnterpriseLeaderContact,
        t1.SecurityLeaderCertID,
        t1.SecurityLeaderName,
        t1.SecurityLeaderContact,
        t1.ChairmanCertID, t1.ChairmanName, t1.ChairmanContact,
        t1.GeneralManagerCertID, t1.GeneralManagerName, t1.GeneralManagerContact,
        t1.IsDangeriousEnterprise,
        t4.HiddenDangerTypeName,
        t5.AttentionTypeName,
        t1.IsCanConstructCPC,
        t1.HasCPC,
        t1.NumberofCPCMember,
        t1.HasLabourUnion,
        t1.NumberofLUMember,
        t1.HasCYL,
        t1.NumberofLCYLMember,
        t1.HasWomenFederation,
        t1.NumberofWomen,
        t1.Longitude,
        t1.Latitude,
        t6.NetGridName,
        t1.BusinessScope
        FROM
        TENonPublicEconomyOrg t1
        LEFT JOIN TECODEEnterpriseType t2
        ON
        t1.EnterpriseTypeValue =
        t2.EnterpriseTypeValue
        LEFT JOIN
        TECODEDocumentType t3
        ON
        t1.EnterpriseLeaderCertTypeValue =
        t3.EnterpriseLeaderCertTypeValue
        LEFT JOIN TECODEHiddenDangerType t4
        ON
        t1.HiddenDangerTypeValue =
        t4.HiddenDangerTypeValue
        LEFT JOIN
        TECODEAttentionTypeValue t5
        ON
        t1.AttentionTypeValue =
        t5.AttentionTypeValue
        LEFT JOIN TENetGrid t6
        ON
        t1.NetGridID=t6.NetGridID where 1=1
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID=#{netGridID}
        </if>
        <if test="isLogisticsEnterprise!=null and isLogisticsEnterprise!=0">
            and
            t1.IsLogisticsEnterprise=#{isLogisticsEnterprise}
        </if>
        <if test="isKeyEnterprise!=null and isKeyEnterprise!=0">
            and t1.IsKeyEnterprise=#{isKeyEnterprise}
        </if>
    </select>

    <select id="getNonPublicEconomyOrgInfoCount" resultType="java.lang.Integer">
        SELECT
        count(*)
        FROM TENonPublicEconomyOrg t1
        left join
        TECODEEnterpriseType t2
        on
        t1.EnterpriseTypeValue=t2.EnterpriseTypeValue
        where 1=1
        <if test="name != null and name != ''">
            and t1.EnterpriseName like CONCAT(CONCAT('%',
            #{name}),
            '%')
        </if>
        <if test="type != null and type != ''">
            and t1.EnterpriseTypeValue =
            #{type}
        </if>
        <if test="netGridID != 0 and netGridID !=null">
            and t1.NetGridID= #{netGridID}
        </if>
        <if test="isLogisticsEnterprise != 0 and isLogisticsEnterprise !=null">
            and t1.IsLogisticsEnterprise= #{isLogisticsEnterprise}
        </if>
        <if test="isKeyEnterprise != 0 and isKeyEnterprise !=null">
            and t1.IsKeyEnterprise= #{isKeyEnterprise}
        </if>
    </select>
    <select id="getHistogram" resultMap="NonpublicHistogramVO">
		SELECT NetGridName,count(t1.EnterpriseUSCcode)
		Count
		FROM TENetGrid t2
		left join TENonPublicEconomyOrg t1
		on
		t1.NetGridID=t2.NetGridID WHERE t2.FatherNetGridID = -1
		group by t2.NetGridName;
	</select>

    <select id="getCount" resultType="java.lang.Integer">
        select count(*)
        from TENonPublicEconomyOrg
        where 1=1
        <if test="netGridID != 0 and netGridID !=null">
            and NetGridID= #{netGridID}
        </if>
    </select>
    <!-- 重点企业数量 -->
    <select id="getKeyEnterpriseCount" resultType="int">
        select count(*)
        from TENonPublicEconomyOrg where IsKeyEnterprise=1
    </select>
    <!-- 物流企业数量 -->
    <select id="getLogisticsEnterpriseCount" resultType="int">
        select count(*)
        from TENonPublicEconomyOrg where
        IsLogisticsEnterprise=1
    </select>

</mapper>