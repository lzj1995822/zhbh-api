<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jtzh.mapper.KeyPetitionersMapper">
    <resultMap id="BaseResultMap" type="com.jtzh.entity.KeyPetitioners">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="TEKeyPID" jdbcType="BIGINT" property="TEKeyPID"/>
        <result column="CertifID" jdbcType="CHAR" property="certifID"/>
        <result column="ActivityCode" jdbcType="CHAR" property="activityCode"/>
        <result column="MeasuresCode" jdbcType="CHAR" property="measuresCode"/>
        <result column="EconomicSourceCode" jdbcType="CHAR" property="economicSourceCode"/>
        <result column="SteadyStateCode" jdbcType="CHAR" property="steadyStateCode"/>
        <result column="SteadyGradeCode" jdbcType="CHAR" property="steadyGradeCode"/>
        <result column="PetitionTypeCode" jdbcType="CHAR" property="petitionTypeCode"/>
        <result column="PetitionStatusCode" jdbcType="CHAR" property="petitionStatusCode"/>
        <result column="ReasonsPetitionReasons" jdbcType="VARCHAR" property="reasonsPetitionReasons"/>
        <result column="DetailSituation" jdbcType="VARCHAR" property="detailSituation"/>
        <result column="TreatmentDetailSituation" jdbcType="VARCHAR" property="treatmentDetailSituation"/>
        <result column="WorkCoordinationDetails" jdbcType="VARCHAR" property="workCoordinationDetails"/>
        <result column="TalkEducationAdmonitionDetails" jdbcType="VARCHAR" property="talkEducationAdmonitionDetails"/>
    </resultMap>
    <resultMap id="KeyPetitionersVO" type="com.jtzh.vo.KeyPetitioners.KeyPetitionersVO">
        <id column="TEKeyPID" jdbcType="BIGINT" property="TEKeyPID"/>
        <result column="Name" jdbcType="VARCHAR" property="name"/>
        <result column="NetGridName" jdbcType="VARCHAR" property="netGridName"/>
        <result column="CertifID" jdbcType="CHAR" property="certifID"/>
        <result column="ActivityTypeName" jdbcType="CHAR" property="activityTypeName"/>
        <result column="MeasuresTypeName" jdbcType="CHAR" property="measuresTypeName"/>
        <result column="EconomicSourceTypeName" jdbcType="CHAR" property="economicSourceTypeName"/>
        <result column="SteadyStateTypeName" jdbcType="CHAR" property="steadyStateTypeName"/>
        <result column="SteadyGradeTypeName" jdbcType="CHAR" property="steadyGradeTypeName"/>
        <result column="PetitionTypeCode" jdbcType="CHAR" property="petitionTypeCode"/>
        <result column="PetitionStatusCode" jdbcType="CHAR" property="petitionStatusCode"/>
        <result column="ReasonsPetitionReasons" jdbcType="VARCHAR" property="reasonsPetitionReasons"/>
        <result column="DetailSituation" jdbcType="VARCHAR" property="detailSituation"/>
        <result column="TreatmentDetailSituation" jdbcType="VARCHAR" property="treatmentDetailSituation"/>
        <result column="WorkCoordinationDetails" jdbcType="VARCHAR" property="workCoordinationDetails"/>
        <result column="TalkEducationAdmonitionDetails" jdbcType="VARCHAR" property="talkEducationAdmonitionDetails"/>
    </resultMap>
    <resultMap id="KeyPetitionersForGISVO" type="com.jtzh.vo.KeyPetitioners.KeyPetitionersForGISVO">
        <id column="TEKeyPID" jdbcType="BIGINT" property="TEKeyPID"/>
        <result column="Name" jdbcType="VARCHAR" property="name"/>
        <result column="NetGridName" jdbcType="VARCHAR" property="netGridName"/>
        <result column="CertifID" jdbcType="CHAR" property="certifID"/>
        <result column="ActivityTypeName" jdbcType="CHAR" property="activityTypeName"/>
        <result column="MeasuresTypeName" jdbcType="CHAR" property="measuresTypeName"/>
        <result column="EconomicSourceTypeName" jdbcType="CHAR" property="economicSourceTypeName"/>
        <result column="SteadyStateTypeName" jdbcType="CHAR" property="steadyStateTypeName"/>
        <result column="SteadyGradeTypeName" jdbcType="CHAR" property="steadyGradeTypeName"/>
        <result column="PetitionTypeCode" jdbcType="CHAR" property="petitionTypeCode"/>
        <result column="PetitionStatusCode" jdbcType="CHAR" property="petitionStatusCode"/>
        <result column="ReasonsPetitionReasons" jdbcType="VARCHAR" property="reasonsPetitionReasons"/>
        <result column="DetailSituation" jdbcType="VARCHAR" property="detailSituation"/>
        <result column="TreatmentDetailSituation" jdbcType="VARCHAR" property="treatmentDetailSituation"/>
        <result column="WorkCoordinationDetails" jdbcType="VARCHAR" property="workCoordinationDetails"/>
        <result column="TalkEducationAdmonitionDetails" jdbcType="VARCHAR" property="talkEducationAdmonitionDetails"/>
        <result column="Longitude" jdbcType="DOUBLE" property="longitude"/>
        <result column="Latitude" jdbcType="DOUBLE" property="latitude"/>
    </resultMap>
    <resultMap id="PieCountVO" type="com.jtzh.vo.gis.PieCountVO">
        <result column="NetGridName" jdbcType="VARCHAR" property="name"/>
        <result column="Value" jdbcType="VARCHAR" property="value"/>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from TEKeyPetitioners
        where TEKeyPID = #{TEKeyPID,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.jtzh.entity.KeyPetitioners">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into TEKeyPetitioners (TEKeyPID, CertifID, ActivityCode,
        MeasuresCode, EconomicSourceCode, SteadyStateCode,
        SteadyGradeCode, PetitionTypeCode, PetitionStatusCode,
        ReasonsPetitionReasons, DetailSituation,
        TreatmentDetailSituation, WorkCoordinationDetails,
        TalkEducationAdmonitionDetails)
        values (#{TEKeyPID,jdbcType=BIGINT}, #{certifID,jdbcType=CHAR}, #{activityCode,jdbcType=CHAR},
        #{measuresCode,jdbcType=CHAR}, #{economicSourceCode,jdbcType=CHAR}, #{steadyStateCode,jdbcType=CHAR},
        #{steadyGradeCode,jdbcType=CHAR}, #{petitionTypeCode,jdbcType=CHAR}, #{petitionStatusCode,jdbcType=CHAR},
        #{reasonsPetitionReasons,jdbcType=VARCHAR}, #{detailSituation,jdbcType=VARCHAR},
        #{treatmentDetailSituation,jdbcType=VARCHAR}, #{workCoordinationDetails,jdbcType=VARCHAR},
        #{talkEducationAdmonitionDetails,jdbcType=VARCHAR})
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.jtzh.entity.KeyPetitioners">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update TEKeyPetitioners
        set CertifID = #{certifID,jdbcType=CHAR},
        ActivityCode = #{activityCode,jdbcType=CHAR},
        MeasuresCode = #{measuresCode,jdbcType=CHAR},
        EconomicSourceCode = #{economicSourceCode,jdbcType=CHAR},
        SteadyStateCode = #{steadyStateCode,jdbcType=CHAR},
        SteadyGradeCode = #{steadyGradeCode,jdbcType=CHAR},
        PetitionTypeCode = #{petitionTypeCode,jdbcType=CHAR},
        PetitionStatusCode = #{petitionStatusCode,jdbcType=CHAR},
        ReasonsPetitionReasons = #{reasonsPetitionReasons,jdbcType=VARCHAR},
        DetailSituation = #{detailSituation,jdbcType=VARCHAR},
        TreatmentDetailSituation = #{treatmentDetailSituation,jdbcType=VARCHAR},
        WorkCoordinationDetails = #{workCoordinationDetails,jdbcType=VARCHAR},
        TalkEducationAdmonitionDetails = #{talkEducationAdmonitionDetails,jdbcType=VARCHAR}
        where TEKeyPID = #{TEKeyPID,jdbcType=BIGINT}
    </update>
    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select TEKeyPID, CertifID, ActivityCode, MeasuresCode, EconomicSourceCode, SteadyStateCode,
        SteadyGradeCode, PetitionTypeCode, PetitionStatusCode, ReasonsPetitionReasons, DetailSituation,
        TreatmentDetailSituation, WorkCoordinationDetails, TalkEducationAdmonitionDetails
        from TEKeyPetitioners
        where TEKeyPID = #{TEKeyPID,jdbcType=BIGINT}
    </select>
    <select id="selectByCertifID" resultMap="BaseResultMap">
        select TEKeyPID, CertifID, ActivityCode, MeasuresCode, EconomicSourceCode, SteadyStateCode,
        SteadyGradeCode, PetitionTypeCode, PetitionStatusCode, ReasonsPetitionReasons, DetailSituation,
        TreatmentDetailSituation, WorkCoordinationDetails, TalkEducationAdmonitionDetails
        from TEKeyPetitioners
        where CertifID = #{certifID}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select TEKeyPID, CertifID, ActivityCode, MeasuresCode, EconomicSourceCode, SteadyStateCode,
        SteadyGradeCode, PetitionTypeCode, PetitionStatusCode, ReasonsPetitionReasons, DetailSituation,
        TreatmentDetailSituation, WorkCoordinationDetails, TalkEducationAdmonitionDetails
        from TEKeyPetitioners
    </select>
    <select id="getKeyPetitionersQuery" resultMap="KeyPetitionersVO">
        select TEKeyPID, t7.Name,t8.NetGridName,t1.CertifID, t2.ActivityTypeName, t3.MeasuresTypeName,
        t4.EconomicSourceTypeName, t5.SteadyStateTypeName,
        t6.SteadyGradeTypeName, PetitionTypeCode, PetitionStatusCode, ReasonsPetitionReasons, DetailSituation,
        TreatmentDetailSituation, WorkCoordinationDetails, TalkEducationAdmonitionDetails
        from TEKeyPetitioners t1
        left join TECODEActivityType t2 on t1.ActivityCode=t2.ActivityTypeValue
        left join TECODEMeasuresType t3 on t1.MeasuresCode=t3.MeasuresTypeValue
        left join TECODEEconomicSourceType t4 on t1.EconomicSourceCode=t4.EconomicSourceTypeValue
        left join TECODESteadyStateType t5 on t1.SteadyStateCode=t5.SteadyStateTypeValue
        left join TECODESteadyGradeType t6 on t1.SteadyGradeCode=t6.SteadyGradeTypeValue
        left join TEServedPersonBasic t7 on t1.CertifID=t7.CertifID
        left join TENetGrid t8 on t7.NetGridID=t8.NetGridID
        where 1=1
        <if test="netGridID!=null and netGridID!=0">
            and t7.NetGridID=#{netGridID}
        </if>
        <if test="name!=null and name!=''">
            and t7.Name like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="certifID!=null and certifID!=''">
            and t1.CertifID =#{certifID}
        </if>
        limit #{start}, #{pageSize}
    </select>
    <select id="getKeyPetitionersQueryCount" resultType="java.lang.Integer">
        select count(*)
        from TEKeyPetitioners t1
        left join TECODEActivityType t2 on t1.ActivityCode=t2.ActivityTypeValue
        left join TECODEMeasuresType t3 on t1.MeasuresCode=t3.MeasuresTypeValue
        left join TECODEEconomicSourceType t4 on t1.EconomicSourceCode=t4.EconomicSourceTypeValue
        left join TECODESteadyStateType t5 on t1.SteadyStateCode=t5.SteadyStateTypeValue
        left join TECODESteadyGradeType t6 on t1.SteadyGradeCode=t6.SteadyGradeTypeValue
        left join TEServedPersonBasic t7 on t1.CertifID=t7.CertifID
        left join TENetGrid t8 on t7.NetGridID=t8.NetGridID
        where 1=1
        <if test="netGridID!=null and netGridID!=0">
            and t7.NetGridID=#{netGridID}
        </if>
        <if test="name!=null and name!=''">
            and t7.Name like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="certifID!=null and certifID!=''">
            and t1.CertifID =#{certifID}
        </if>
    </select>

    <select id="getKeyPetitionersPieCount" resultMap="PieCountVO">
        select tg.NetGridName,ifnull(tt.value,0) Value from TENetGrid tg left join
       (SELECT NetGridName,count(*) value
		FROM TEKeyPetitioners t1
		left join TEServedPersonBasic t2 on
		t1.CertifID=t2.CertifID
        left join TENetGrid t3 on
        t2.NetGridID=t3.NetGridID
        group by NetGridName) tt on tg.NetGridName=tt.NetGridName
        where tg.FatherNetGridID=-1;
    </select>


    <select id="selectWithLocation" resultMap="KeyPetitionersForGISVO">
        select TEKeyPID, t7.Name,t8.NetGridName,t1.CertifID, t2.ActivityTypeName, t3.MeasuresTypeName,
        t4.EconomicSourceTypeName, t5.SteadyStateTypeName,
        t6.SteadyGradeTypeName, PetitionTypeCode, PetitionStatusCode, ReasonsPetitionReasons, DetailSituation,
        TreatmentDetailSituation, WorkCoordinationDetails, TalkEducationAdmonitionDetails,t11.Longitude,t11.Latitude
        from TEKeyPetitioners t1
        left join TECODEActivityType t2 on t1.ActivityCode=t2.ActivityTypeValue
        left join TECODEMeasuresType t3 on t1.MeasuresCode=t3.MeasuresTypeValue
        left join TECODEEconomicSourceType t4 on t1.EconomicSourceCode=t4.EconomicSourceTypeValue
        left join TECODESteadyStateType t5 on t1.SteadyStateCode=t5.SteadyStateTypeValue
        left join TECODESteadyGradeType t6 on t1.SteadyGradeCode=t6.SteadyGradeTypeValue
        left join TEServedPersonBasic t7 on t1.CertifID=t7.CertifID
        left join TENetGrid t8 on t7.NetGridID=t8.NetGridID
        left join TEServedPersonBasic t9 on
        t1.CertifID=t9.CertifID
        left join TRPersonHouse t10
        on
        t9.ServedPersonID=t10.ServedPersonID
        left join TEHouse t11 on
        t10.HouseID=t11.HouseID
        where 1=1
        <if test="netGridID!=null and netGridID!=0">
            and t7.NetGridID=#{netGridID}
        </if>
    </select>


    <select id="getCountForGIS" resultType="int">
        select count(*) from TEKeyPetitioners t1
        left join TEServedPersonBasic t2 on t1.CertifID=t2.CertifID
        where 1=1
        <if test="netGridID != 0 and netGridID !=null">
            and t2.NetGridID= #{netGridID}
        </if>
    </select>

</mapper>