<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jtzh.mapper.TrafficAccidentMapper">
    <resultMap id="BaseResultMap" type="com.jtzh.entity.TrafficAccident">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        <id column="TrafficAccidentID" jdbcType="BIGINT" property="trafficAccidentID"/>
        <result column="TrafficAccidentName" jdbcType="VARCHAR"
                property="trafficAccidentName"/>
        <result column="TrafficAccidentKind" jdbcType="CHAR"
                property="trafficAccidentKind"/>
        <result column="TrafficAccidentTypeValue" jdbcType="CHAR"
                property="trafficAccidentTypeValue"/>
        <result column="TrafficAccidentContent" jdbcType="VARCHAR"
                property="trafficAccidentContent"/>
        <result column="TrafficAccidentStartDateTime" jdbcType="TIMESTAMP"
                property="trafficAccidentStartDateTime"/>
        <result column="TrafficAccidentEndDateTime" jdbcType="TIMESTAMP"
                property="trafficAccidentEndDateTime"/>
        <result column="TrafficAccidentHappenLongitude" jdbcType="DOUBLE"
                property="trafficAccidentHappenLongitude"/>
        <result column="TrafficAccidentHappenLatitude" jdbcType="DOUBLE"
                property="trafficAccidentHappenLatitude"/>
        <result column="TrafficAccidentStatusTypeValue" jdbcType="CHAR"
                property="trafficAccidentStatusTypeValue"/>
        <result column="CurrentRemarks" jdbcType="VARCHAR" property="currentRemarks"/>
        <result column="CurrentResponsiblePersonCertID" jdbcType="CHAR"
                property="currentResponsiblePersonCertID"/>
        <result column="CurrentResponsiblePersonName" jdbcType="VARCHAR"
                property="currentResponsiblePersonName"/>
        <result column="CurrentResponsiblePersonContact" jdbcType="VARCHAR"
                property="currentResponsiblePersonContact"/>
        <result column="NetGridID" jdbcType="BIGINT" property="netGridID"/>
    </resultMap>

    <resultMap id="TrafficAccidentVO" type="com.jtzh.vo.gis.TrafficAccidentVO">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        <id column="TrafficAccidentID" jdbcType="BIGINT" property="trafficAccidentID"/>
        <result column="TrafficAccidentName" jdbcType="VARCHAR"
                property="trafficAccidentName"/>
        <result column="TrafficAccidentKind" jdbcType="CHAR"
                property="trafficAccidentKind"/>
        <result column="TrafficAccidentTypeValue" jdbcType="CHAR"
                property="trafficAccidentTypeValue"/>
        <result column="TrafficAccidentContent" jdbcType="VARCHAR"
                property="trafficAccidentContent"/>
        <result column="TrafficAccidentStartDateTime" jdbcType="TIMESTAMP"
                property="trafficAccidentStartDateTime"/>
        <result column="TrafficAccidentEndDateTime" jdbcType="TIMESTAMP"
                property="trafficAccidentEndDateTime"/>
        <result column="TrafficAccidentHappenLongitude" jdbcType="DOUBLE"
                property="trafficAccidentHappenLongitude"/>
        <result column="TrafficAccidentHappenLatitude" jdbcType="DOUBLE"
                property="trafficAccidentHappenLatitude"/>
        <result column="TrafficAccidentStatusTypeValue" jdbcType="CHAR"
                property="trafficAccidentStatusTypeValue"/>
        <result column="CurrentRemarks" jdbcType="VARCHAR" property="currentRemarks"/>
        <result column="CurrentResponsiblePersonCertID" jdbcType="CHAR"
                property="currentResponsiblePersonCertID"/>
        <result column="CurrentResponsiblePersonName" jdbcType="VARCHAR"
                property="currentResponsiblePersonName"/>
        <result column="CurrentResponsiblePersonContact" jdbcType="VARCHAR"
                property="currentResponsiblePersonContact"/>
        <result column="NetGridID" jdbcType="BIGINT" property="netGridID"/>
        <result column="TrafficAccidentKindName" jdbcType="VARCHAR"
                property="trafficAccidentKindName"/>
        <result column="TrafficAccidentTypeName" jdbcType="VARCHAR"
                property="trafficAccidentTypeName"/>
        <result column="TrafficAccidentStatusTypeName" jdbcType="VARCHAR"
                property="trafficAccidentStatusTypeName"/>
    </resultMap>

    <resultMap id="TrafficAccidentVO1" type="com.jtzh.vo.trafficAccident.TrafficAccidentVO">
        <id column="TrafficAccidentID" jdbcType="BIGINT" property="trafficAccidentID"/>
        <result column="TrafficAccidentName" jdbcType="VARCHAR"
                property="trafficAccidentName"/>
        <result column="TrafficAccidentContent" jdbcType="VARCHAR"
                property="trafficAccidentContent"/>
        <result column="TrafficAccidentStartDateTime" jdbcType="VARCHAR"
                property="trafficAccidentStartDateTime"/>
        <result column="TrafficAccidentEndDateTime" jdbcType="VARCHAR"
                property="trafficAccidentEndDateTime"/>
        <result column="TrafficAccidentHappenLongitude" jdbcType="DOUBLE"
                property="trafficAccidentHappenLongitude"/>
        <result column="TrafficAccidentHappenLatitude" jdbcType="DOUBLE"
                property="trafficAccidentHappenLatitude"/>
        <result column="CurrentRemarks" jdbcType="VARCHAR" property="currentRemarks"/>
        <result column="CurrentResponsiblePersonCertID" jdbcType="CHAR"
                property="currentResponsiblePersonCertID"/>
        <result column="CurrentResponsiblePersonName" jdbcType="VARCHAR"
                property="currentResponsiblePersonName"/>
        <result column="CurrentResponsiblePersonContact" jdbcType="VARCHAR"
                property="currentResponsiblePersonContact"/>
        <result column="TrafficAccidentKindName" jdbcType="VARCHAR"
                property="trafficAccidentKindName"/>
        <result column="TrafficAccidentTypeName" jdbcType="VARCHAR"
                property="trafficAccidentTypeName"/>
        <result column="TrafficAccidentStatusTypeName" jdbcType="VARCHAR"
                property="trafficAccidentStatusTypeName"/>
        <result column="NetGridName" jdbcType="VARCHAR"
                property="netGridName"/>
        <result column="RealName" jdbcType="VARCHAR" property="realName"/>
        <result column="Dept" jdbcType="VARCHAR" property="dept"/>
        <result column="MobileTel" jdbcType="VARCHAR" property="mobileTel"/>
    </resultMap>
    <resultMap id="TrafficAccidentExVO" type="com.jtzh.vo.trafficAccident.TrafficAccidentExVO">
        <id column="TrafficAccidentID" jdbcType="BIGINT" property="trafficAccidentID"/>
        <result column="TrafficAccidentName" jdbcType="VARCHAR"
                property="trafficAccidentName"/>
        <result column="TrafficAccidentKind" jdbcType="CHAR"
                property="trafficAccidentKind"/>
        <result column="TrafficAccidentTypeValue" jdbcType="CHAR"
                property="trafficAccidentTypeValue"/>
        <result column="TrafficAccidentContent" jdbcType="VARCHAR"
                property="trafficAccidentContent"/>
        <result column="TrafficAccidentStartDateTime" jdbcType="TIMESTAMP"
                property="trafficAccidentStartDateTime"/>
        <result column="TrafficAccidentEndDateTime" jdbcType="TIMESTAMP"
                property="trafficAccidentEndDateTime"/>
        <result column="TrafficAccidentHappenLongitude" jdbcType="DOUBLE"
                property="trafficAccidentHappenLongitude"/>
        <result column="TrafficAccidentHappenLatitude" jdbcType="DOUBLE"
                property="trafficAccidentHappenLatitude"/>
        <result column="TrafficAccidentStatusTypeValue" jdbcType="CHAR"
                property="trafficAccidentStatusTypeValue"/>
        <result column="CurrentRemarks" jdbcType="VARCHAR" property="currentRemarks"/>
        <result column="CurrentResponsiblePersonCertID" jdbcType="CHAR"
                property="currentResponsiblePersonCertID"/>
        <result column="CurrentResponsiblePersonName" jdbcType="VARCHAR"
                property="currentResponsiblePersonName"/>
        <result column="CurrentResponsiblePersonContact" jdbcType="VARCHAR"
                property="currentResponsiblePersonContact"/>
        <result column="NetGridID" jdbcType="BIGINT" property="netGridID"/>
        <result column="TrafficAccidentKindName" jdbcType="VARCHAR"
                property="trafficAccidentKindName"/>
        <result column="TrafficAccidentTypeName" jdbcType="VARCHAR"
                property="trafficAccidentTypeName"/>
        <result column="TrafficAccidentStatusTypeName" jdbcType="VARCHAR"
                property="trafficAccidentStatusTypeName"/>
        <result column="NetGridName" jdbcType="VARCHAR"
                property="netGridName"/>
    </resultMap>
    <resultMap type="com.jtzh.vo.served.SpecialPersonPieVO" id="SpecialPersonPieVO">
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="value" jdbcType="INTEGER" property="value"/>
    </resultMap>
    <resultMap id="PieCountVO" type="com.jtzh.vo.gis.PieCountVO">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        <result column="type" jdbcType="VARCHAR" property="name"/>
        <result column="count" jdbcType="INTEGER" property="value"/>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        delete from TETrafficAccident
        where TrafficAccidentID =
        #{trafficAccidentID,jdbcType=BIGINT}
    </delete>


    <resultMap id="TrafficCountCheckVO" type="com.jtzh.vo.dispute.DisputeEventCountVO">
        <result column="NetGridName" jdbcType="VARCHAR" property="name"/>
        <result column="complete" jdbcType="INTEGER" property="solved"/>
        <result column="incomplete" jdbcType="INTEGER" property="unsolved"/>
    </resultMap>

    <insert id="insert" parameterType="com.jtzh.entity.TrafficAccident"
            keyProperty="trafficAccidentID" useGeneratedKeys="true">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        insert into TETrafficAccident (TrafficAccidentID, TrafficAccidentName,
        TrafficAccidentKind, TrafficAccidentTypeValue,
        TrafficAccidentContent,
        TrafficAccidentStartDateTime,
        TrafficAccidentEndDateTime,
        TrafficAccidentHappenLongitude,
        TrafficAccidentHappenLatitude,
        TrafficAccidentStatusTypeValue,
        CurrentRemarks,
        CurrentResponsiblePersonCertID,
        CurrentResponsiblePersonName,
        CurrentResponsiblePersonContact,
        NetGridID)
        values
        (#{trafficAccidentID,jdbcType=BIGINT},
        #{trafficAccidentName,jdbcType=VARCHAR},
        #{trafficAccidentKind,jdbcType=CHAR},
        #{trafficAccidentTypeValue,jdbcType=CHAR},
        #{trafficAccidentContent,jdbcType=VARCHAR},
        #{trafficAccidentStartDateTime,jdbcType=TIMESTAMP},
        #{trafficAccidentEndDateTime,jdbcType=TIMESTAMP},
        #{trafficAccidentHappenLongitude,jdbcType=DOUBLE},
        #{trafficAccidentHappenLatitude,jdbcType=DOUBLE},
        #{trafficAccidentStatusTypeValue,jdbcType=CHAR},
        #{currentRemarks,jdbcType=VARCHAR},
        #{currentResponsiblePersonCertID,jdbcType=CHAR},
        #{currentResponsiblePersonName,jdbcType=VARCHAR},
        #{currentResponsiblePersonContact,jdbcType=VARCHAR},
        #{netGridID,jdbcType=BIGINT})
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.jtzh.entity.TrafficAccident">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        update TETrafficAccident
        set TrafficAccidentName =
        #{trafficAccidentName,jdbcType=VARCHAR},
        TrafficAccidentKind =
        #{trafficAccidentKind,jdbcType=CHAR},
        TrafficAccidentTypeValue =
        #{trafficAccidentTypeValue,jdbcType=CHAR},
        TrafficAccidentContent =
        #{trafficAccidentContent,jdbcType=VARCHAR},
        TrafficAccidentStartDateTime =
        #{trafficAccidentStartDateTime,jdbcType=TIMESTAMP},
        TrafficAccidentEndDateTime =
        #{trafficAccidentEndDateTime,jdbcType=TIMESTAMP},
        TrafficAccidentHappenLongitude =
        #{trafficAccidentHappenLongitude,jdbcType=DOUBLE},
        TrafficAccidentHappenLatitude =
        #{trafficAccidentHappenLatitude,jdbcType=DOUBLE},
        TrafficAccidentStatusTypeValue =
        #{trafficAccidentStatusTypeValue,jdbcType=CHAR},
        CurrentRemarks =
        #{currentRemarks,jdbcType=VARCHAR},
        CurrentResponsiblePersonCertID =
        #{currentResponsiblePersonCertID,jdbcType=CHAR},
        CurrentResponsiblePersonName =
        #{currentResponsiblePersonName,jdbcType=VARCHAR},
        CurrentResponsiblePersonContact =
        #{currentResponsiblePersonContact,jdbcType=VARCHAR},
        NetGridID =
        #{netGridID,jdbcType=BIGINT}
        where TrafficAccidentID =
        #{trafficAccidentID,jdbcType=BIGINT}
    </update>
    <update id="updateTrafficAccidentStatus">
        update TETrafficAccident
        set
        TrafficAccidentStatusTypeValue =
        #{type}
        where TrafficAccidentID =
        #{id,jdbcType=BIGINT}
    </update>
    <select id="selectByPrimaryKey" parameterType="java.lang.Long"
            resultMap="BaseResultMap">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select TrafficAccidentID, TrafficAccidentName, TrafficAccidentKind,
        TrafficAccidentTypeValue,
        TrafficAccidentContent,
        TrafficAccidentStartDateTime, TrafficAccidentEndDateTime,
        TrafficAccidentHappenLongitude, TrafficAccidentHappenLatitude,
        TrafficAccidentStatusTypeValue,
        CurrentRemarks,
        CurrentResponsiblePersonCertID, CurrentResponsiblePersonName,
        CurrentResponsiblePersonContact,
        NetGridID
        from TETrafficAccident
        where
        TrafficAccidentID = #{trafficAccidentID,jdbcType=BIGINT}
    </select>
    <select id="getTrafficAccidentDetail"
            resultMap="TrafficAccidentVO1">
        SELECT TrafficAccidentID, TrafficAccidentName, t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,
        TrafficAccidentContent,
        TrafficAccidentStartDateTime, TrafficAccidentEndDateTime,
        TrafficAccidentHappenLongitude, TrafficAccidentHappenLatitude,
        t4.TrafficAccidentStatusTypeName,
        CurrentRemarks,
        CurrentResponsiblePersonCertID, CurrentResponsiblePersonName,
        CurrentResponsiblePersonContact,
        t5.NetGridName,RealName,Dept,MobileTel
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        left join TEUser t6 on
        t1.CurrentResponsiblePersonCertID=t6.UserID
        WHERE TrafficAccidentID=#{id}
    </select>
    <select id="getTrafficAccidentQuery"
            resultMap="TrafficAccidentVO1">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        SELECT TrafficAccidentID, TrafficAccidentName, t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,
        TrafficAccidentContent,
        TrafficAccidentStartDateTime, TrafficAccidentEndDateTime,
        TrafficAccidentHappenLongitude, TrafficAccidentHappenLatitude,
        t4.TrafficAccidentStatusTypeName,
        CurrentRemarks,
        CurrentResponsiblePersonCertID, CurrentResponsiblePersonName,
        CurrentResponsiblePersonContact,
        t5.NetGridName FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        WHERE 1=1
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        order by TrafficAccidentStartDateTime desc
        limit #{start}, #{pageSize}
    </select>
    <select id="getTrafficAccidentQueryCount" resultType="java.lang.Integer">
        SELECT count(*) FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        WHERE 1=1
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select TrafficAccidentID, TrafficAccidentName, TrafficAccidentKind,
        TrafficAccidentTypeValue,
        TrafficAccidentContent,
        TrafficAccidentStartDateTime, TrafficAccidentEndDateTime,
        TrafficAccidentHappenLongitude, TrafficAccidentHappenLatitude,
        TrafficAccidentStatusTypeValue,
        CurrentRemarks,
        CurrentResponsiblePersonCertID, CurrentResponsiblePersonName,
        CurrentResponsiblePersonContact,
        NetGridID
        from TETrafficAccident
    </select>

    <select id="getTrafficAccidentByStatus" resultMap="TrafficAccidentVO">
        select
        t1.*,t2.TrafficAccidentKindName,t3.TrafficAccidentTypeName,t4.TrafficAccidentStatusTypeName
        from TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on
        t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join
        TECODETrafficAccidentType t3
        on
        t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join
        TECODETrafficAccidentStatusType t4
        on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        where 1=1
        <choose>
            <when test="type!=null and type!='07'">
                and t1.TrafficAccidentStatusTypeValue='07'
            </when>
            <when test="type!=null">
                and t1.TrafficAccidentStatusTypeValue!='07'
            </when>
            <when test="netGridID!=0 and netGridID!=null">
                and t1.NetGridID=#{netGridID}
            </when>
        </choose>
    </select>

    <select id="getTrafficAccidentHistogramCount" resultMap="SpecialPersonPieVO">
       select tg.NetGridName name,ifnull(tt.count,0) value from TENetGrid tg left join
(select NetGridName,count(*) count from TETrafficAccident t1
left join TENetGrid t2
on t1.NetGridID=t2.NetGridID
group by NetGridName) tt on tg.NetGridName=tt.NetGridName where tg.FatherNetGridID=-1;
    </select>

    <select id="getUnSovleCount" resultType="java.lang.Integer">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select count(*) from TETrafficAccident where 1=1
        and TrafficAccidentStatusTypeValue !='07'
        <if test="netGridID != 0 and netGridID !=null">
            and NetGridID= #{netGridID}
        </if>
    </select>

    <select id="getSovleCount" resultType="java.lang.Integer">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select count(*)
        from TETrafficAccident where 1=1
        and TrafficAccidentStatusTypeValue = '07'
        <if test="netGridID != 0 and netGridID !=null">
            and NetGridID= #{netGridID}
        </if>
    </select>
    <select id="getTrafficAccidentPieCount" resultMap="PieCountVO">
        <!-- WARNING - @mbg.generated This element is automatically generated by
            MyBatis Generator, do not modify. -->
        select t2.TrafficAccidentKindName name,count(*) value from
        TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on
        t1.TrafficAccidentKind=t2.TrafficAccidentKind
        where 1=1
        <if test="netGridID != 0 and netGridID !=null">
            and NetGridID= #{netGridID}
        </if>
        group by
        t2.TrafficAccidentKindName
    </select>


    <select id="getTrafficAccidentReporterQuery"
            resultMap="TrafficAccidentExVO">
        SELECT t1.*,t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,t4.TrafficAccidentStatusTypeName,t5.NetGridName
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        left join TEUser t6 on CurrentResponsiblePersonCertID=UserID
        WHERE 1=1 and UserID=#{id}
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
        order by TrafficAccidentStartDateTime desc
        limit #{start}, #{pageSize}
    </select>

    <select id="getTrafficAccidentReporterQueryCount"
            resultType="java.lang.Integer">
        SELECT count(*)
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        left join TEUser t6 on CurrentResponsiblePersonCertID=UserID
        WHERE 1=1 and UserID=#{id}
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
    </select>

    <select id="getTrafficAccidentDespatcherQuery"
            resultMap="TrafficAccidentExVO">
        SELECT t1.*,t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,t4.TrafficAccidentStatusTypeName,t5.NetGridName
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentDistribute t6 on t1.TrafficAccidentID=t6.EventID
        where 1=1 and (t1.TrafficAccidentStatusTypeValue='01' or t1.TrafficAccidentStatusTypeValue='03' or
        t1.TrafficAccidentStatusTypeValue='04'
        or t6.UserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
        group by t1.TrafficAccidentID
        order by TrafficAccidentStartDateTime desc
        limit #{start}, #{pageSize}
    </select>

    <select id="getTrafficAccidentDespatcherQueryCount"
            resultType="java.lang.Integer">
        SELECT count(DISTINCT t1.TrafficAccidentID)
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentDistribute t6 on t1.TrafficAccidentID=t6.EventID
        where 1=1 and (t1.TrafficAccidentStatusTypeValue='01' or t1.TrafficAccidentStatusTypeValue='03' or
        t1.TrafficAccidentStatusTypeValue='04'
        or t6.UserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
    </select>
    <select id="getTrafficAccidentDeptDespatcherQuery"
            resultMap="TrafficAccidentExVO">
        SELECT t1.*,t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,t4.TrafficAccidentStatusTypeName,t5.NetGridName
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentDistribute t6 on t1.TrafficAccidentID=t6.EventID
        where 1=1 and (t6.AcceptedUserID=#{id}
        or t6.UserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
        group by t1.TrafficAccidentID
        order by TrafficAccidentStartDateTime desc
        limit #{start}, #{pageSize}
    </select>

    <select id="getTrafficAccidentDeptDespatcherQueryCount"
            resultType="java.lang.Integer">
        SELECT count(DISTINCT t1.TrafficAccidentID)
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5
        on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentDistribute t6 on t1.TrafficAccidentID=t6.EventID
        where 1=1 and (t6.AcceptedUserID=#{id}
        or t6.UserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
    </select>
    <select id="getTrafficAccidentHandlerQuery"
            resultMap="TrafficAccidentExVO">
        SELECT t1.*,t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,t4.TrafficAccidentStatusTypeName,t5.NetGridName
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5 on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentDistribute t6 on t1.TrafficAccidentID=t6.EventID
        left join TRNetGridEventDealing t7 on t1.TrafficAccidentID=t6.EventID
        where 1=1 and (t6.AcceptedUserID=#{id} or t7.DealingUserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
        group by t1.TrafficAccidentID
        order by TrafficAccidentStartDateTime desc
        limit #{start}, #{pageSize}
    </select>

    <select id="getTrafficAccidentHandlerQueryCount"
            resultType="java.lang.Integer">
        SELECT count(DISTINCT t1.TrafficAccidentID)
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5 on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentDistribute t6 on t1.TrafficAccidentID=t6.EventID
        left join TRNetGridEventDealing t7 on t1.TrafficAccidentID=t6.EventID
        where 1=1 and (t6.AcceptedUserID=#{id} or t7.DealingUserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
    </select>
    <select id="getTrafficAccidentAuditorQuery"
            resultMap="TrafficAccidentExVO">
        SELECT t1.*,t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,t4.TrafficAccidentStatusTypeName,t5.NetGridName
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5 on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentChecked t6 on t1.TrafficAccidentID=t6.EventID
        where 1=1 and (t1.TrafficAccidentStatusTypeValue='06'
        or t6.CheckedUserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
        group by t1.TrafficAccidentID
        order by TrafficAccidentStartDateTime desc
        limit #{start}, #{pageSize}
    </select>

    <select id="getTrafficAccidentAuditorQueryCount"
            resultType="java.lang.Integer">
        SELECT count(DISTINCT t1.TrafficAccidentID)
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5 on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentChecked t6 on t1.TrafficAccidentID=t6.EventID
        where 1=1 and (t1.TrafficAccidentStatusTypeValue='06'
        or t6.CheckedUserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
    </select>


    <select id="getTrafficAccidentAPPQuery"
            resultMap="TrafficAccidentExVO">
        SELECT t1.*,t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,t4.TrafficAccidentStatusTypeName,t5.NetGridName
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5 on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentDistribute t6 on t1.TrafficAccidentID=t6.EventID
        left join TRTrafficAccidentDealing t7 on t1.TrafficAccidentID=t7.EventID
        left join TEUser t8 on t1.CurrentResponsiblePersonCertID=t8.UserID
        where 1=1 and (t6.AcceptedUserID=#{id} or t7.DealingUserID=#{id} or t8.UserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
        group by t1.TrafficAccidentID
        order by TrafficAccidentStartDateTime desc
        limit #{start}, #{pageSize}
    </select>

    <select id="getTrafficAccidentAPPQueryCount"
            resultType="java.lang.Integer">
        SELECT count(DISTINCT t1.TrafficAccidentID)
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5 on t1.NetGridID=t5.NetGridID
        left join TRTrafficAccidentDistribute t6 on t1.TrafficAccidentID=t6.EventID
        left join TRTrafficAccidentDealing t7 on t1.TrafficAccidentID=t7.EventID
        left join TEUser t8 on t1.CurrentResponsiblePersonCertID=t8.UserID
        where 1=1 and (t6.AcceptedUserID=#{id} or t7.DealingUserID=#{id} or t8.UserID=#{id})
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
    </select>

    <select id="getTrafficEventCountForCheck" resultMap="TrafficCountCheckVO">
        select tn.NetGridName,ifnull(ta.common,0) complete,ifnull(ta.great,0) incomplete from TENetGrid tn left join
        (SELECT t2.NetGridName,sum(case when t1.TrafficAccidentStatusTypeValue='07' then 1 else 0 end) common,
        sum(case when t1.TrafficAccidentStatusTypeValue!='07' then 1 else 0 end) great
        FROM TETrafficAccident t1
        left join TENetGrid t2 on
        t1.NetGridID=t2.NetGridID
        where 1=1
        <if test="start!=null ">
            and TrafficAccidentStartDateTime <![CDATA[>=]]>#{start}
        </if>
        <if test="end!=null">
            and TrafficAccidentStartDateTime <![CDATA[<=]]>#{end}
        </if>
        group by t2.NetGridName)ta on tn.NetGridName=ta.NetGridName where tn.FatherNetGridID=-1 order by tn.NetGridID;
    </select>

    <select id="getTrafficEventByStatus" resultType="java.util.Map">
        select ifnull(sum(case when TrafficAccidentStatusTypeValue='07' then 1 else 0 end),0) solved,
        ifnull(sum(case when TrafficAccidentStatusTypeValue!='07' then 1 else 0 end),0)unsolved
        from TETrafficAccident
        where 1=1
        <if test="start!=null ">
            and TrafficAccidentStartDateTime <![CDATA[>=]]>#{start}
        </if>
        <if test="end!=null">
            and TrafficAccidentStartDateTime <![CDATA[<=]]>#{end}
        </if>
    </select>

    <select id="getTrafficEventCountByNetGrid" resultType="java.util.Map">
       select tn.NetGridName,ifnull(ta.count,0) value from TENetGrid tn left join
      (SELECT t2.NetGridName,count(*) count
      FROM TETrafficAccident t1
      left join TENetGrid t2 on
      t1.NetGridID=t2.NetGridID
      group by t2.NetGridName)ta on tn.NetGridName=ta.NetGridName where tn.FatherNetGridID=-1 order by tn.NetGridID;
    </select>


    <select id="getTrafficAccidentForNetGrid"
            resultMap="TrafficAccidentExVO">
        SELECT t1.*,t2.TrafficAccidentKindName,
        t3.TrafficAccidentTypeName,t4.TrafficAccidentStatusTypeName,t5.NetGridName
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5 on t1.NetGridID=t5.NetGridID
        where 1=1
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
        group by t1.TrafficAccidentID
        order by TrafficAccidentStartDateTime desc
        limit #{start}, #{pageSize}
    </select>

    <select id="getTrafficAccidentForNetGridCount"
            resultType="java.lang.Integer">
        SELECT count(DISTINCT t1.TrafficAccidentID)
        FROM TETrafficAccident t1
        left join TECODETrafficAccidentKind t2
        on t1.TrafficAccidentKind=t2.TrafficAccidentKind
        left join TECODETrafficAccidentType t3
        on t1.TrafficAccidentTypeValue=t3.TrafficAccidentTypeValue
        left join TECODETrafficAccidentStatusType t4 on
        t1.TrafficAccidentStatusTypeValue=t4.TrafficAccidentStatusTypeValue
        left join TENetGrid t5 on t1.NetGridID=t5.NetGridID
        where 1=1
        <if test="name!=null and name!=''">
            and TrafficAccidentName like CONCAT(CONCAT('%',
            #{name}), '%')
        </if>
        <if test="type!=null and type!=''">
            and t1.TrafficAccidentTypeValue =#{type}
        </if>
        <if test="netGridID!=null and netGridID!=0">
            and t1.NetGridID =#{netGridID}
        </if>
        <if test="status!=null and status!=''">
            and t1.TrafficAccidentStatusTypeValue =#{status}
        </if>
    </select>

</mapper>